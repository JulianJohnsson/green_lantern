<% content_for :title, "Comparer" %>
<div class="row">
  <div class="col-md-12 text-center">
    <div class="card">
      <div class="card-header card-header-info">
        <div class="emoji-title">
          ðŸ“ˆ
          <h4>Evolution de ton impact carbone mensuel</h4>
        </div>
      </div>
      <div class="card-body">
        <%= line_chart [{ name: 'Ton impact', data: @average_history.map { |a| [a.created_at, current_user.transactions.carbone_contribution.where("date <= ? and date > ?", a.created_at, a.created_at - 1.month).sum(:carbone)] } }, { name: 'Moyenne des membres Carbo', data: @average_history.map { |a| [a.created_at, a.month_total*1000/12] } }], defer: true, points: false, :style => "margin-top:30px;", suffix: " kg", decimal: "," %>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-12 text-center">
    <div class="card">
      <div class="card-header card-header-info">
        <div class="emoji-title">
          ðŸ“ˆ
          <h4>Ton score</h4>
        </div>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-2">
            <p>Ton impact calculÃ©</p>
            <span class="text-danger number number-sm">
              <%= number_with_precision(@score, precision: 0) %>
              kgCO2
            </span>
          </div>
          <div class="col-2">
            <p>Ton arbre Carbo</p>
            <span class="text-primary number number-sm">
              <%= number_with_precision(@badge, precision: 0) %>
            </span>
          </div>
          <div class="col-2">
            <p>Ta forÃªt proche</p>
            <span class="text-primary number number-sm">
              <%= number_with_precision(@friends, precision: 0) %>
            </span>
          </div>
          <div class="col-2">
            <p>Ta compensation</p>
            <span class="text-primary number number-sm">
              <%= number_with_precision(@project, precision: 0) %>
            </span>
          </div>
          <div class="col-4">
            <p>Ton score</p>
            <span class="text-rose number number-md">
              <%= number_with_precision(@score+@badge+@friends+@project, precision: 0) %>
              kgCO2
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-12 text-center">
    <div class="card">
      <div class="card-header card-header-info">
        <div class="emoji-title">
          ðŸ“ˆ
          <h4>Classement</h4>
        </div>
      </div>
      <div class="card-body">
        <%= @ranking %>
      </div>
    </div>
  </div>
</div>
